{% load static %}
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Documents for {{ project.wa_number }}</title>
  <link rel="stylesheet" href="{% static 'vds/style.css' %}">
  <style>
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 0.4rem; }
    th { background: #f5f5f5; }
    .controls { margin-bottom: 1rem; }
  </style>
</head>
<body>
  <h1>Project {{ project.wa_number }} â€” {{ project.title }}</h1>

  <form id="documents-form" method="post" action="">
    {% csrf_token %}
    <div class="controls">
      <label for="action-select">Action:</label>
      <select id="action-select" name="action">
        <option value="">-- choose --</option>
        <option value="delete">Delete</option>
        <option value="replace">Replace</option>
        <option value="issue">Issue</option>
      </select>
      <button type="submit">Apply</button>
    </div>

    <table>
      <thead>
        <tr>
          <th><input id="select-all" type="checkbox"></th>
          <th>Latest Rev</th>
          <th>Latest Issue</th>
          <th>Stub</th>
          <th>Document number</th>
        </tr>
      </thead>
      <tbody>
        {% for d in documents %}
        <tr>
          <td><input class="select-doc" type="checkbox" name="selected" value="{{ d.id }}"></td>
          <td>{{ d.revision_number }}</td>
          <td>{{ d.latest_issue }}</td>
          <td>{{ d.stub }}</td>
          <td><a href="{% url 'vds:document_details' d.id %}">{{ d.document_number }}</a></td>
        </tr>
        {% empty %}
        <tr><td colspan="5">No documents found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </form>

  <script>
    document.getElementById('select-all').addEventListener('change', function(e){
      const checked = e.target.checked;
      document.querySelectorAll('.select-doc').forEach(cb => cb.checked = checked);
    });
  </script>
</body>
</html>
